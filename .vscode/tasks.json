{
  "version": "2.0.0",
  "problemMatcher": [],
  "tasks": [
    {
      "label": "Compile & Start entire Open5GS stack",
      "type": "shell",
      "dependsOrder": "sequence",
      "dependsOn": [
        "Terminate Open5GS",
        "Compile Open5GS",
        "Start entire Open5GS stack"
      ],
      "presentation": {
        "close": true
      }
    },
    {
      "label": "Compile Open5GS",
      "type": "shell",
      "command": "rm -rf ./install/bin && rm -rf ./install/lib && source ./custom-env.sh && meson setup build --prefix=$PWD/install && cd build && ninja -j$(nproc) && ninja install",
      "dependsOn": [
        "Terminate Open5GS"
      ]
    },
    {
      "label": "View Open5GS state",
      "type": "shell",
      "command": "bash -c 'output=$(ps aux | grep [o]pen5gs); if [ -z \"$output\" ]; then echo \"Open5GS not active\"; else echo \"$output\"; fi'"
    },
    {
      "label": "Launch tests for Open5GS",
      "type": "shell",
      "command": "cd build && sudo ninja test"
    },
    {
      "label": "Terminate Open5GS",
      "type": "shell",
      "command": "sudo pkill -9 -f 'open5gs*'; pkill -f 'npm run dev'; pkill -f 'mongosh'",
      "presentation": {
        "close": true
      }
    },
    {
      "label": "Start MongoDB",
      "dependsOn": [
        //"webui",
        "mongodb"
      ]
    },
    {
      "label": "Start entire Open5GS stack",
      "dependsOn": [
        //"webui",
        "mongodb",
        "nrf",
        "scp",
        "amf",
        "smf",
        "ausf",
        "udm",
        "udr",
        "pcf",
        "nssf",
        "bsf",
        "upf"
      ]
    },
    {
      "label": "webui",
      "type": "shell",
      "command": "npm run dev",
      "hide": true
    },
    {
      "label": "mongodb",
      "type": "shell",
      "command": "mongosh --host 127.0.0.1 --port 27017 open5gs",
      "hide": true
    },
    {
      "label": "Initialize network",
      "type": "shell",
      "command": "sudo ./custom-setup_network.sh",
    },
    {
      "label": "Termina webui",
      "type": "shell",
      "command": "lsof -ti :9999 | xargs -r kill -9",
      "hide": true
    },
    {
      "label": "nrf",
      "type": "shell",
      "command": "source ./custom-env.sh && ./install/bin/open5gs-nrfd",
      "hide": true
    },
    {
      "label": "scp",
      "type": "shell",
      "command": "sleep 2 && source ./custom-env.sh && ./install/bin/open5gs-scpd",
      "hide": true
    },
    {
      "label": "amf",
      "type": "shell",
      "command": "sleep 2 && source ./custom-env.sh && ./install/bin/open5gs-amfd",
      "hide": true
    },
    {
      "label": "smf",
      "type": "shell",
      "command": "sleep 2 && source ./custom-env.sh && ./install/bin/open5gs-smfd",
      "hide": true
    },
    {
      "label": "ausf",
      "type": "shell",
      "command": "sleep 2 && source ./custom-env.sh && ./install/bin/open5gs-ausfd",
      "hide": true
    },
    {
      "label": "udm",
      "type": "shell",
      "command": "sleep 2 && source ./custom-env.sh && ./install/bin/open5gs-udmd",
      "hide": true
    },
    {
      "label": "udr",
      "type": "shell",
      "command": "sleep 2 && source ./custom-env.sh && ./install/bin/open5gs-udrd",
      "hide": true
    },
    {
      "label": "pcf",
      "type": "shell",
      "command": "sleep 2 && source ./custom-env.sh && ./install/bin/open5gs-pcfd",
      "hide": true
    },
    {
      "label": "nssf",
      "type": "shell",
      "command": "sleep 2 && source ./custom-env.sh && ./install/bin/open5gs-nssfd",
      "hide": true
    },
    {
      "label": "bsf",
      "type": "shell",
      "command": "sleep 2 && source ./custom-env.sh && ./install/bin/open5gs-bsfd",
      "hide": true
    },
    {
      "label": "upf",
      "type": "shell",
      "command": "source ./custom-env.sh && sudo -E ./install/bin/open5gs-upfd",
      "hide": true
    }
  ]
}